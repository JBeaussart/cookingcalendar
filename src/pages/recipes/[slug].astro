---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const recipes = await getCollection("recipes");
  return recipes.map((recipe) => ({
    params: { slug: recipe.slug },
    props: { recipe },
  }));
}

const { recipe } = Astro.props;
const { title, image, ingredients, steps } = recipe.data;
---

<Layout title={title}>
  <div class="container mx-auto px-4 py-12">

    {image && (
      <div class="overflow-hidden rounded-xl shadow-lg mb-8">
        <img
          src={image}
          alt={title}
          class="w-full h-72 object-cover transform hover:scale-105 transition duration-500"
        />
      </div>
    )}

    <h1 class="text-4xl md:text-5xl font-extrabold text-center mb-12 text-gray-900">
      {title}
    </h1>

    <div class="grid gap-8 md:grid-cols-2">
      <!-- Ingrédients -->
      <section class="bg-yellow-50 rounded-xl p-6 shadow-lg hover:shadow-2xl transition">
        <h2 class="flex items-center text-2xl font-semibold mb-4 text-yellow-800">
          <span class="mr-2">🛒</span> Ingrédients
        </h2>
        <ul class="list-disc list-inside space-y-2 text-gray-700">
          {ingredients.map(({ item, quantity, unit }) => (
            <li>
              {quantity ? `${quantity} ${unit ?? ""} ${item}` : item}
            </li>
          ))}
        </ul>
      </section>

      <!-- Préparation -->
      <section class="bg-green-50 rounded-xl p-6 shadow-lg hover:shadow-2xl transition">
        <h2 class="flex items-center text-2xl font-semibold mb-4 text-green-800">
          <span class="mr-2">👩‍🍳</span> Préparation
        </h2>
        <ol class="list-decimal list-inside space-y-2 text-gray-700">
          {steps.map((s, i) => (
            <li key={i}>{s}</li>
          ))}
        </ol>
      </section>
    </div>

    <div class="mt-12 text-center">
      <a
        href="/recipes"
        class="inline-block bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-xl shadow-lg transition transform hover:-translate-y-1"
      >
        ← Retour à toutes les recettes
      </a>
    </div>
  </div>
</Layout>
